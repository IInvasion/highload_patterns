Паттерн "Несколько сервисов на одном хосте" (Multiple Services per Host) предлагает способ развертывания нескольких экземпляров различных сервисов на одном физическом или виртуальном сервере в микросервисной архитектуре.

## Контекст

В рамках микросервисной архитектуры система состоит из набора сервисов, каждый из которых развёрнут как набор экземпляров для обеспечения пропускной способности и доступности.

## Проблема

Основная задача заключается в том, как упаковывать и развертывать сервисы.

## Силы

- Сервисы могут быть написаны на различных языках и использовать разные фреймворки.
- Каждый сервис состоит из нескольких экземпляров для повышения пропускной способности и доступности.
- Сервисы должны быть независимыми в развертывании и масштабировании.
- Экземпляры сервисов должны быть изолированы друг от друга.
- Необходима быстрая сборка и развертывание сервиса.
- Требуется ограничить ресурсы (ЦП и память), потребляемые сервисом.
- Необходим мониторинг поведения каждого экземпляра сервиса.
- Развертывание должно быть надежным и экономически эффективным.

## Решение

Решение заключается в запуске нескольких экземпляров различных сервисов на одном хосте. Это можно сделать несколькими способами:

- Развёртывание каждого экземпляра сервиса как процесса JVM (например, Tomcat или Jetty).
- Развёртывание нескольких экземпляров сервиса в одной JVM (например, как веб-приложения или OSGI-бандлы).

## Результирующий контекст

Преимущества данного паттерна включают:

- Более эффективное использование ресурсов по сравнению с паттерном "Один сервис на хосте".

Недостатки включают:

- Риск конфликтов в требованиях к ресурсам.
- Риск конфликтов версий зависимостей.
- Сложности в ограничении ресурсов, потребляемых экземпляром сервиса.
- Если несколько экземпляров сервисов развернуты в одном процессе, трудно контролировать потребление ресурсов каждым экземпляром, а также невозможно обеспечить полную изоляцию.

## Связанные паттерны

- Паттерн "Один сервис на хосте" является альтернативным решением.
- Паттерн "Безсерверное развертывание" также может служить альтернативой.

Этот паттерн позволяет эффективно управлять ресурсами при развертывании микросервисов, обеспечивая более высокую эффективность использования серверных мощностей.

[Ссылка на источник](https://microservices.io/patterns/deployment/multiple-services-per-host.html)