Паттерн **"Разделение по поддоменам"** предлагает подход к проектированию микросервисной архитектуры, при котором приложение делится на сервисы, соответствующие различным поддоменам в рамках бизнес-домена. Это позволяет создать более устойчивую и эффективную архитектуру, способствующую быстрой разработке и развертыванию.

## Контекст

При разработке крупных и сложных приложений с использованием микросервисной архитектуры важно правильно разделить приложение на сервисы. Каждый сервис должен быть достаточно малым, чтобы его могла разрабатывать небольшая команда (6-10 человек), и легко тестироваться. Применение принципов объектно-ориентированного проектирования, таких как Принцип единственной ответственности (SRP) и Принцип общей закрытости (CCP), помогает в этом процессе.

## Проблема

Основная задача заключается в том, как правильно разбить приложение на сервисы, соответствующие поддоменам.

## Силы

Ключевые факторы, которые необходимо учитывать при разделении:

- Архитектура должна быть стабильной.
- Сервисы должны быть когерентными, реализуя небольшой набор взаимосвязанных функций.
- Сервисы должны соответствовать Принципу общей закрытости — изменения должны затрагивать только один сервис.
- Сервисы должны быть слабо связаны между собой, что позволяет изменять реализацию без влияния на клиентов.
- Каждый сервис должен быть тестируемым.

## Решение

Сервисы следует определять в соответствии с поддоменами, используя подход **Domain-Driven Design (DDD)**. Поддомен — это часть бизнеса, которая имеет свою собственную область ответственности. Поддомены можно классифицировать следующим образом:

- **Ключевые поддомены**: Основные отличия бизнеса и наиболее ценная часть приложения.
- **Поддерживающие поддомены**: Связаны с бизнесом, но не являются его отличительной чертой; могут быть реализованы внутри компании или переданы на аутсорсинг.
- **Генерические поддомены**: Не специфичны для бизнеса и лучше всего реализуются с использованием готового программного обеспечения.

## Примеры

Для интернет-магазина поддомены могут включать:

- Управление каталогом продуктов
- Управление запасами
- Управление заказами
- Управление доставкой

Каждый из этих поддоменов может соответствовать отдельному микросервису в архитектуре.

## Результирующий контекст

Этот паттерн обеспечивает следующие преимущества:

- Стабильная архитектура благодаря относительной стабильности поддоменов.
- Кросс-функциональные команды, организованные вокруг предоставления бизнес-ценности.
- Когерентные и слабо связанные сервисы.

## Проблемы

Некоторые проблемы, которые необходимо решить:

- Как идентифицировать поддомены? Это требует понимания бизнеса и анализа его структуры и процессов. Хорошими отправными точками для идентификации являются организационная структура и высокоуровневая модель домена.

## Связанные паттерны

Паттерн "Разделение по бизнес-способностям" является альтернативным подходом к проектированию микросервисов.

[Ссылка на источник](https://microservices.io/patterns/decomposition/decompose-by-subdomain.html)