Паттерн **"База данных на сервис"** (Database per Service) является ключевым элементом архитектуры микросервисов, который предполагает, что каждый микросервис имеет свою собственную базу данных. Это обеспечивает Loose Coupling (слабую связанность) между сервисами и позволяет им развиваться, развертываться и масштабироваться независимо друг от друга.

## Основные аспекты паттерна:

- **Изоляция данных**: Каждая база данных является приватной для своего сервиса и доступна только через его API. Это предотвращает прямой доступ к данным других сервисов и способствует инкапсуляции.
- **Разнообразие технологий**: Каждый сервис может использовать наиболее подходящий тип базы данных в зависимости от своих потребностей. Например, один сервис может использовать реляционную базу данных, а другой — NoSQL.

## Решения для реализации:

1. **Private-tables-per-service**: Каждому сервису принадлежат определенные таблицы в общей базе данных.
2. **Schema-per-service**: Каждый сервис имеет свою схему в общей базе данных.
3. **Database-server-per-service**: Каждый сервис имеет собственный сервер базы данных.

## Преимущества:

- **Слабая связанность**: Изменения в базе данных одного сервиса не влияют на другие сервисы.
- **Оптимизация под нужды сервиса**: Возможность выбора наиболее подходящей базы данных для конкретного сервиса.

## Недостатки:

- **Сложности с распределенными транзакциями**: Реализация бизнес-транзакций, охватывающих несколько сервисов, может быть сложной и неэффективной из-за CAP-теоремы.
- **Сложности с объединением данных**: Запросы, которые требуют объединения данных из нескольких баз, могут быть затруднительными.

## Подходы к решению проблем:

- **Saga pattern**: Используется для реализации транзакций, которые должны быть согласованными между несколькими сервисами.
- **API Composition**: Объединение данных происходит на уровне приложения, а не базы данных.
- **CQRS (Command Query Responsibility Segregation)**: Поддержка материализованных представлений, которые содержат данные из нескольких сервисов.

## Примеры использования:

Примером применения данного паттерна является приложение FTGO, где каждый сервис имеет учетные данные базы данных, которые позволяют ему получать доступ только к своей логической базе на общем сервере MySQL. Таким образом, паттерн "База данных на сервис" способствует созданию независимых и легко управляемых микросервисов, но требует дополнительных усилий для решения вопросов интеграции и управления данными.

[Ссылка на источник](https://microservices.io/patterns/index.html)