Паттерн "Сегрегация ответственности команд и запросов" (CQRS) описывает подход к обработке запросов в архитектуре микросервисов, где данные распределены между различными сервисами.

## Контекст

При использовании архитектуры микросервисов и паттерна "База данных на сервис" становится сложно выполнять запросы, которые требуют объединения данных из нескольких источников. Если также применяется паттерн "Событийное хранение", это усугубляет проблему доступности данных для запросов.

## Проблема

Основная задача заключается в том, как реализовать запросы, которые извлекают данные из нескольких сервисов.

## Решение

Решение состоит в создании **представления базы данных** — только для чтения "реплики", которая оптимизирована для поддержки конкретных запросов или группы связанных запросов. Эта база данных обновляется путем подписки на доменные события, публикуемые сервисами, владеющими данными. Обычно используется NoSQL база данных, такая как документная база данных или хранилище ключ-значение.

## Результаты

## Преимущества

- Поддержка нескольких денормализованных представлений, которые масштабируемы и производительны.
- Улучшенная сегрегация ответственности, что упрощает модели команд и запросов.
- Необходимость в архитектуре с событийным хранением.

## Недостатки

- Увеличение сложности системы.
- Потенциальное дублирование кода.
- Задержка репликации и "в конечном счете согласованные" представления.

## Связанные паттерны

- Паттерн "База данных на сервис" создает необходимость в CQRS.
- Паттерн "Составление API" является альтернативным решением.
- Паттерн "Доменные события" генерирует события.
- CQRS часто используется с событийным хранением.

Этот паттерн позволяет эффективно управлять запросами в микросервисной архитектуре, но требует внимательного управления сложностью и согласованностью данных.

[Ссылка на хранение](https://microservices.io/patterns/data/cqrs.html)